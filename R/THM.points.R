#*********************************************
#*********************************************
#' ***DECRIPTION MISSING***
#'
#'
#' @return
#'
#' @examples
#' \dontrun{}
#'
#' @export
#' @rdname THM.points
#'

THM.points=function(p,level=5,A=Inf,bronze=TRUE){
	if(length(p)>100){
		level=1
		}
	
	
	W=c(34,34,26,26,26,15)
	POW=c(3,3,1,1,1,1)
	MAXP=c(1000,990,980,900,700,400)
	
	score=points2score(p,pow=POW[level],w=W[level],maxp=MAXP[level],bronze=bronze)
	bonus=rank2bonus(length(p),A=A,level=level,bronze=bronze)
	cbind(rank=seq_along(p),WR=p,score=score,bonus=bonus,total=score+bonus)
	}
	
#bb=c(439, 352, 263, 205, 137, 97, 75, 46, 34, 20, 8, 1)
#THM.points (bb,5,Inf,TRUE)
 
#oo=c(635,614,584,426,272,131,1)
#THM.points (oo,5,Inf,TRUE)

#NM=c(826,819,808,808,800,796,788,774,758,742,727,712,670,620,566,514,471,409,355,281,228,191,146,124,100,84,68,49,32,16,10,9,8,7,6,5,4,3,2,1)
#THM.points (NM,4,24,TRUE)

#BO=c(817,806,792,792,771,750,711,658,597,538,492,448,397,348,281,228,175,120,82,43,29,18,16,13,12,11,10,9,8,7,6,5,4,3,2,1)
#THM.points (BO,4,20,TRUE)

#SM=c(971,967,964,962,959,956,953,951,948,945,942,938,936,934,931,929,926,924,923,921,921,920,918,916,914,912,911,911,911,910,910,909,908,908,907,905,904,902,900,897,895,893,891,889,888,887,885,884,883,881,880,879,878,877,875,873,872,870,869,867,866,864,862,858,854,846,839,833,826,822,818,815,812,809,803,798,793,782,775,761,747,737,724,706,690,670,655,645,629,616,602,589,578,565,549,509,460,404,333,273,222,173,132,98,64,40,23,14,10,9,8,7,6,5,4,3,2,1)
#THM.points (SM,2,48,TRUE)[c(17,22,34,44,46,52,56,58,61,77,81),]

#OO=c(950,943,932,932,922,917,914,911,908,904,901,899,897,896,894,893,891,889,888,886,885,884,881,877,873,870,864,857,849,834,822,811,793,778,760,740,727,716,708,701,691,674,656,635,614,591,558,527,498,465,419,352,283,228,152,99,1)
#THM.points (OO,2,32,TRUE)[c(9,11,15,18,19,23,24,28,32,33,38,41,42,44,45,46,48,51,52,53,55,57),]


